var siteurl="http://localhost/tamrielfoundry/",themeurl=siteurl+"wp-content/themes/apocrypha/",ajaxurl=siteurl+"wp-admin/admin-ajax.php",$=jQuery;$(document).ready(function(){$("#top-login-form").submit(function(){return $("input#login-submit").attr("disabled","disabled"),$("input#login-submit").attr("value","..."),$.ajax({type:"POST",dataType:"json",data:$(this).serialize(),url:ajaxurl,success:function(a){1==a.success?window.location=a.redirect:($("input#login-submit").removeAttr("disabled"),$("input#login-submit").attr("value","Log In"),$("#top-login-error").html(a.error),$("#top-login-error").fadeToggle("slow"))}}),!1})}),$(document).ready(function(){function a(a,b){for(var c=a.split("?"),d=c[1].split("&"),e=0;e<d.length;e++){var f=d[e].split("=");if(f[0]==b)return f[1]}return""}function b(){if(count=0,$.each(["activity","messages","groups","friends"],function(a,b){target=$("li#notifications-"+b+" span.notifications-number"),target.is("*")&&(count+=parseInt(target.text()))}),count>0){var a=$("title").text().replace(/\[.*\]/,"");a="["+count+"]"+a,$("title").text(a)}}$("a.clear-notification").click(function(b){var c=$(this),d=a(c.attr("href"),"_wpnonce"),e=a(c.attr("href"),"notid"),f=a(c.attr("href"),"type");b.preventDefault(),c.removeAttr("href"),c.html(" &#x2713;"),$.post(ajaxurl,{action:"apoc_clear_notification",_wpnonce:d,notid:e},function(a){a&&(counter=$("li#notifications-"+f+" span.notifications-number"),count=parseInt(counter.text()),count>1?(counter.text(count-1),c.parent().remove()):(counter.remove(),c.parent().text("Notifications cleared!")),title=$("title").text(),count=title.split("]")[0].substr(1),title=count>1?title.replace(count,count-1):title.replace(/\[(.*)\]/,""),document.title=title)})}),b()}),$(document).ready(function(){$("a.backtotop").click(function(){return $("html, body").animate({scrollTop:0},600),!1})}),$(document).ready(function(){$("a.reply-link").click(function(){var a=$(this).attr("href");return $("html, body").animate({scrollTop:$(a).offset().top},600),!1})}),$(document).ready(function(){$("a.quote-link").click(function(a){a.preventDefault();var b=quoteParent=quoteSource=posttext=quote="";if(postid=$(this).data("id"),author=$(this).data("author"),date=$(this).data("date"),b=$(this).attr("href"),"#forum-reply"==b?(quoteParent="#post-"+postid,quoteSource="#content-post-"+postid,editor="bbp_reply_content"):"#respond"==b&&(quoteParent="#comment-"+postid,quoteSource="#comment-"+postid+" .reply-content",editor="comment"),window.getSelection)posttext=window.getSelection().toString();else{if(!document.selection||"Control"==document.selection.type)return;posttext=document.selection.createRange().text}return""!=posttext&&(postlines=posttext.split(/\r?\n/),firstline=postlines[0],lastline=postlines[postlines.length-1],0==$(quoteSource).find(":contains("+firstline+")").length||0==$(quoteSource).find(":contains("+lastline+")").length)?(alert("This is not a valid quote selection. Either select a specific passage or select nothing to quote the full post."),void 0):(""==posttext&&(posttext=$(quoteSource).html().toString()),posttext=posttext.replace(/<ul id="bbp-reply-revision((.|\n)*?)(<\/ul>)/,""),posttext=posttext.replace(/<ul id="bbp-topic-revision((.|\n)*?)(<\/ul>)/,""),posttext=posttext.replace(/<div class="spoiler">((.|\n)*?)(<\/div>)/g,""),posttext=posttext.replace(/<img((.|\n)*?)(>)/g,""),posttext=posttext.replace(/<br>/g,""),posttext=posttext.replace(/&nbsp;/g,""),posttext=posttext.replace(/<button class="quote-toggle((.|\n)*?)(<\/button>)/g,""),posttext=posttext.replace(/display: none;/g,""),quote='\r\n\r\n[quote author="'+author+"|"+quoteParent.substring(1)+"|"+date+'"]',quote+="\r\n"+posttext,quote+="\r\n[/quote]\r\n\r\n&nbsp;",editor_html=document.getElementById(editor+"-html"),switchEditors.switchto(editor_html),document.getElementById(editor).value+=quote,editor_tmce=document.getElementById(editor+"-tmce"),switchEditors.switchto(editor_tmce),$("html, body").animate({scrollTop:$(b).offset().top},600),void 0)})}),$(document).ready(function(){$("div.quote").children("div.quote").addClass("subquote"),$("div.subquote").children("p.quote-author").append('<button class="quote-toggle button-dark">Expand Quote</button>'),$("div.subquote").children().not("p.quote-author,div.subquote").hide(),$("button.quote-toggle").click(function(){var a=newtext="";$(this).parent().parent().children().not("p.quote-author,div.subquote").slideToggle(500,"swing"),a=$(this).text(),newtext="Expand Quote"==a?"Collapse Quote":"Expand Quote",$(this).text(newtext)})}),$(document).ready(function(){$("div.spoiler").children("p.spoiler-title").append('<button class="spoiler-toggle button-dark">Reveal Spoiler</button>'),$("div.spoiler").children().not("p.spoiler-title").hide(),$("button.spoiler-toggle").click(function(){var a=newtext="";$(this).parent().parent().children().not("p.spoiler-title").slideToggle(500,"swing"),a=$(this).text(),newtext="Reveal Spoiler"==a?"Conceal Spoiler":"Reveal Spoiler",$(this).text(newtext)})}),$(document).ready(function(){$("a.delete-comment-link").click(function(){confirmation=confirm("Permanently delete this comment?"),confirmation&&(button=$(this),button.text("Deleting..."),commentid=$(this).data("id"),nonce=$(this).data("nonce"),$.post(ajaxurl,{action:"apoc_delete_comment",_wpnonce:nonce,commentid:commentid},function(a){a&&$("li#comment-"+commentid+" div.reply-body").slideUp("slow",function(){$("li#comment-"+commentid).remove()})}))})}),$(document).ready(function(){$("form#commentform").submit(function(a){var b="",c=$(this),d=c.attr("action"),e=$("#submit",c),f=$("#comment",c);a.preventDefault(),e.attr("disabled","disabled"),e.parent().prepend('<div id="comment-notice"></div>'),$("#comment-notice").hide(),tinyMCE.triggerSave(),""==f.val()&&(b="You didn't write anything!"),b||(e.attr("value","Submitting..."),$.ajax({url:d,type:"post",data:c.serialize(),success:function(a){$("#respond").slideUp("slow",function(){$("#respond").remove(),$("ol#comment-list").append(a),$("ol#comment-list li.reply:last-child").hide().slideDown("slow")})},error:function(){b="An error occurred during posting."}})),b&&($("#comment-notice").addClass("error").text(b).fadeToggle("slow"),e.removeAttr("disabled"))})});