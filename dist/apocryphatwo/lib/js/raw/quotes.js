$(document).ready(function(){$("a.quote-link").click(function(a){a.preventDefault();var b=quoteParent=quoteSource=posttext=quote="";if(postid=$(this).data("id"),author=$(this).data("author"),date=$(this).data("date"),b=$(this).attr("href"),"#forum-reply"==b?(quoteParent="#post-"+postid,quoteSource="#content-post-"+postid,editor="bbp_reply_content"):"#respond"==b&&(quoteParent="#comment-"+postid,quoteSource="#comment-"+postid+" .reply-content",editor="comment"),window.getSelection)posttext=window.getSelection().toString();else{if(!document.selection||"Control"==document.selection.type)return;posttext=document.selection.createRange().text}return""!=posttext&&(postlines=posttext.split(/\r?\n/),firstline=postlines[0],lastline=postlines[postlines.length-1],0==$(quoteSource).find(":contains("+firstline+")").length||0==$(quoteSource).find(":contains("+lastline+")").length)?(alert("This is not a valid quote selection. Either select a specific passage or select nothing to quote the full post."),void 0):(""==posttext&&(posttext=$(quoteSource).html().toString()),posttext=posttext.replace(/<ul id="bbp-reply-revision((.|\n)*?)(<\/ul>)/,""),posttext=posttext.replace(/<ul id="bbp-topic-revision((.|\n)*?)(<\/ul>)/,""),posttext=posttext.replace(/<div class="spoiler">((.|\n)*?)(<\/div>)/g,""),posttext=posttext.replace(/<img((.|\n)*?)(>)/g,""),posttext=posttext.replace(/<br>/g,""),posttext=posttext.replace(/&nbsp;/g,""),posttext=posttext.replace(/<button class="quote-toggle((.|\n)*?)(<\/button>)/g,""),posttext=posttext.replace(/display: none;/g,""),quote='\r\n\r\n[quote author="'+author+"|"+quoteParent.substring(1)+"|"+date+'"]',quote+="\r\n"+posttext,quote+="\r\n[/quote]\r\n\r\n&nbsp;",editor_html=document.getElementById(editor+"-html"),switchEditors.switchto(editor_html),document.getElementById(editor).value+=quote,editor_tmce=document.getElementById(editor+"-tmce"),switchEditors.switchto(editor_tmce),$("html, body").animate({scrollTop:$(b).offset().top},600),void 0)})}),$(document).ready(function(){$("a.reply-link").click(function(){var a=$(this).attr("href");return $("html, body").animate({scrollTop:$(a).offset().top},600),!1})}),$(document).ready(function(){$("div.quote").children("div.quote").addClass("subquote"),$("div.subquote").children("p.quote-author").append('<button class="quote-toggle button-dark">Expand Quote</button>'),$("div.subquote").children().not("p.quote-author,div.subquote").hide(),$("button.quote-toggle").click(function(){var a=newtext="";$(this).parent().parent().children().not("p.quote-author,div.subquote").slideToggle(500,"swing"),a=$(this).text(),newtext="Expand Quote"==a?"Collapse Quote":"Expand Quote",$(this).text(newtext)})}),$(document).ready(function(){$("div.spoiler").children("p.spoiler-title").append('<button class="spoiler-toggle button-dark">Reveal Spoiler</button>'),$("div.spoiler").children().not("p.spoiler-title").hide(),$("button.spoiler-toggle").click(function(){var a=newtext="";$(this).parent().parent().children().not("p.spoiler-title").slideToggle(500,"swing"),a=$(this).text(),newtext="Reveal Spoiler"==a?"Conceal Spoiler":"Reveal Spoiler",$(this).text(newtext)})});