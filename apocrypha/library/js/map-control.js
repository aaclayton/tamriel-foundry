var $=jQuery;var esomap;var siteurl="http://tamrielfoundry.com/";var tileurl="http://tamriel.objects.dreamhost.com/";var assets="http://tamrielfoundry.com/wp-content/themes/apocrypha/library/map/";if("localhost"==window.location.host){siteurl="http://localhost/tamrielfoundry/";tileurl="http://localhost/eso-map/tiles/";assets="http://localhost/tamrielfoundry/wp-content/themes/apocrypha/library/map/"}var zone="";var locations=[];var activeMarkers=[];var zoneCoords;var allowedBounds;var iconver=0.72;var tilever=0.3;var infowindow;$(document).ready(function(){interactiveMap(zone)});function interactiveMap(a){var e={getTileUrl:function(h,g){var f=Math.pow(2,g);h.x=(Math.abs(h.x)<Math.pow(2,g))?Math.abs(h.x):Math.pow(2,g)-1;h.y=(Math.abs(h.y)<Math.pow(2,g))?Math.abs(h.y):Math.pow(2,g)-1;return tileurl+g+"_"+h.x+"_"+h.y+".jpg?ver="+tilever},tileSize:new google.maps.Size(256,256),maxZoom:7,minZoom:2,opacity:1,name:"ESO Interactive Map"};var b=new google.maps.ImageMapType(e);var c={center:new google.maps.LatLng(0,0),zoom:2,streetViewControl:false,mapTypeControl:false,backgroundColor:"black",draggableCursor:"crosshair"};esomap=new google.maps.Map(document.getElementById("map-canvas"),c);esomap.mapTypes.set("interactive-map",b);esomap.setMapTypeId("interactive-map");allowedBounds=set_bounds("new");google.maps.event.addListener(esomap,"zoom_changed",function(){set_bounds();maybe_hide_markers()});var d=esomap.getCenter();google.maps.event.addListener(esomap,"center_changed",function(){if(allowedBounds.contains(esomap.getCenter())){d=esomap.getCenter();return}esomap.panTo(d)});infowindow=new google.maps.InfoWindow();if(""!==a){get_markers()}}function set_bounds(){var j=esomap.getZoom();var a=esomap.getCenter();var c=[[-35,-20,35,20],[-70,-100,70,100],[-75,-120,75,120],[-80,-130,80,130],[-85,-135,85,135],[-87,-140,87,140]];var d=c[j-2][0];var e=c[j-2][1];var f=c[j-2][2];var h=c[j-2][3];allowedBounds=new google.maps.LatLngBounds(new google.maps.LatLng(d,e),new google.maps.LatLng(f,h));function b(k){return k>0?1:k<0?-1:0}if(!allowedBounds.contains(a)){if(Math.abs(a.lat())>Math.abs(d)){goodLat=b(a.lat())*(Math.abs(d)-0.01)}else{goodLat=a.lat()}if(Math.abs(a.lng())>Math.abs(e)){goodLng=b(a.lng())*(Math.abs(e)-0.01)}else{goodLng=a.lng()}var g=new google.maps.LatLng(goodLat,goodLng);esomap.panTo(g)}return allowedBounds}function clear_markers(){for(var a=0;a<activeMarkers.length;a++){activeMarkers[a].setMap(null)}activeMarkers=[]}function maybe_hide_markers(){var c=esomap.getZoom();var a=true;if(c<=3){a=false}for(var b=0;b<activeMarkers.length;b++){activeMarkers[b].setVisible(a)}}function get_zone_coords(a){var b={};b.roost=[-68,1.2,6];b.auridon=[-48.93,-76.4,5];b.grahtwood=[-55.42,-18.81,5];b.greenshade=[-48.7,-46.9,5];b.malabal=[-33.4,-39.5,5];b.reapers=[-29.88,-12,5];b.stros=[-12.43,-96.52,6];b.betnikh=[16.06,-120.61,6];b.glenumbra=[37.04,-121.27,5];b.stormhaven=[46.85,-80.66,5];b.rivenspire=[60.13,-92.49,5];b.bangkorai=[42.76,-59.81,5];b.alikr=[29.71,-90.13,5];b.bleakrock=[56.2,53.8,7];b.balfoyen=[16.1,95.1,7];b.stonefalls=[15.15,74,5];b.deshaan=[-3.95,85.33,5];b.shadowfen=[-22.25,77.75,5];b.therift=[35,38,5];b.eastmarch=[50.6,38.75,5];b.cyrodiil=[0.52,16.82,4];return b[a]}function is_zone_enabled(a){var b=["roost","bleakrock","balfoyen","stros","betnikh"];for(i=0;i<b.length;i++){if(b[i]==a){return true}}return false}function get_markers(){clear_markers();zone=$("select#zone-select :selected").attr("value");coords=get_zone_coords(zone);zoneCoords=new google.maps.LatLng(coords[0],coords[1]);esomap.setZoom(coords[2]);esomap.panTo(zoneCoords);if(is_zone_enabled(zone)){$.getScript(assets+"zones/"+zone+".js",function(){for(i=0;i<locations.length;i++){var a={url:assets+"icons/"+locations[i][1]+".png?ver="+iconver,size:new google.maps.Size(24,24),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(12,12)};marker=new google.maps.Marker({position:new google.maps.LatLng(locations[i][3],locations[i][4]),map:esomap,id:i,title:locations[i][0],desc:locations[i][2],type:locations[i][1],icon:a});activeMarkers.push(marker);google.maps.event.addListener(marker,"click",(function(){var d=$("<div />").html(this.desc).text();var c=$("<div />").html(this.title).text();var b='<div class="marker-window"><h3 class="marker-title">'+c+'</h3><p class="marker-content">'+d+"</p></div>";infowindow.setContent(b);infowindow.open(esomap,this)}))}})}}function ClearMarker(){var a=$("#map-controls");a.find("#editid").attr("value",0);a.find("#latFld").attr("value","");a.find("#lngFld").attr("value","");a.find("#nameFld").attr("value","");a.find("#typeFld").attr("value","");a.find("#descFld").attr("value","");a.find("#context").attr("value","new");alert("Form Reset!")};